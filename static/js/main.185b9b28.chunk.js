(this.webpackJsonpeartrain=this.webpackJsonpeartrain||[]).push([[0],{26:function(e,t,a){e.exports=a(37)},31:function(e,t,a){},37:function(e,t,a){"use strict";a.r(t);var n=a(0),l=a.n(n),o=a(19),s=a.n(o),c=(a(31),a(6)),r=a(10),i=a(11),u=a(24),m=a(20),h=a(12),p=a(25),k=a(2),E=a(7),N=(a(9),function(){function e(){Object(r.a)(this,e),this.note_stack=[],this.guess_stack=[],this.result_stack=[],this.start=!1,this.addGuess=this.addGuess.bind(this),this.addNote=this.addNote.bind(this),this.calcScore=this.calcScore.bind(this)}return Object(i.a)(e,[{key:"addNote",value:function(e){for(;this.guess_stack.length!==this.note_stack.length;)this.guess_stack.unshift("-");this.note_stack.unshift(e)}},{key:"addNoteArr",value:function(e){for(;this.guess_stack.length!==this.note_stack.length;)this.guess_stack.unshift("-");for(var t in e)this.note_stack.unshift(e[t])}},{key:"addGuess",value:function(e){return this.guess_stack.length!==this.note_stack.length?(console.log(this.note_stack),this.guess_stack.unshift(e),this.result_stack.unshift(e===this.note_stack[this.note_stack.length-this.guess_stack.length])):console.log("wrong length"),this.result_stack[0]}},{key:"calcScore",value:function(){for(var e=0,t=0;t<this.note_stack.length;++t)t<this.guess_stack.length&&this.note_stack[t]===this.guess_stack[t]&&++e;return 0===e?[0,0]:[e,Math.round(e/this.note_stack.length*100)]}}]),e}());function g(e){return l.a.createElement("tr",null,l.a.createElement("th",{className:"Results-table-cell"},e.index,"."),l.a.createElement("th",{className:"Results-table-cell"},e.guess),l.a.createElement("th",{className:"Results-table-cell"},e.note),l.a.createElement("th",{className:"Results-table-cell"},e.result?"\u2713":"X"))}var C=function(e){var t=e.notes.slice(e.notes.length-e.guesses.length,e.notes.length);return l.a.createElement("div",{className:"App App-header"},l.a.createElement("h2",null,"Score: ",e.score[1],"% (",e.score[0]," / ",e.results.length,")"),l.a.createElement("table",{className:"Results-table"},l.a.createElement("thead",null,l.a.createElement("tr",null,l.a.createElement("th",{className:"Results-table-cell"}),l.a.createElement("th",{className:"Results-table-cell"},"Guess"),l.a.createElement("th",{className:"Results-table-cell"},"Note"),l.a.createElement("th",{className:"Results-table-cell"},"Result"))),l.a.createElement("tbody",null,e.guesses.map((function(a,n){return[a,t[n],e.results[n]]})).map((function(t,a){return l.a.createElement(g,{key:a,index:e.guesses.length-a,guess:t[0],note:t[1],result:t[2]})})))))};var b=function(){return l.a.createElement("div",{className:"App"},l.a.createElement("header",{className:"App-header"},l.a.createElement("h1",null,"Settings"),l.a.createElement("p",null,l.a.createElement(k.c,{to:"/"},l.a.createElement("button",{className:"App-button colorGreen"},"Home")),l.a.createElement(k.c,{to:"/train"},l.a.createElement("button",{className:"App-button colorCoral"},"Start Training")))))},d=a(23),f=a.n(d),v=["C4","C#4","D4","Eb4","E4","F4","F#4","G4","Ab4","A4","Bb4","B4","C5","C#5","D5","Eb5","E5","F5","F#5","G5","Ab5","A5","Bb5","B5","C6"];function _(e){return Math.floor(Math.random()*e)}var y=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{duration:"4n",max_leap:4,mode:"major",num_notes:3,range:2,gap:1,synth:{oscillator:{type:"triangle"},envelope:{attackCurve:"exponential",attack:.01,decayCurve:"exponential",decay:.01,sustain:.1,releaseCurve:"exponential",release:.3},portamento:0,volume:-12}};switch(Object(r.a)(this,e),this.scale=[],this.prev_note=-1,console.log("building toneGen with props",t),this.duration=t.duration,this.max_leap=t.max_leap,this.num_notes=t.num_notes,this.gap=t.gap,t.mode){case"major":this.scale=[0,2,4,5,7,9,11,12,14,16,17,19,21,23,24];break;case"minor":this.scale=[0,2,3,5,7,8,10,11,12,14,15,17,19,20,22,23,24];break;case"blues":this.scale=[0,3,5,6,7,10,12,15,17,18,19,22,24];break;case"pentatonic":this.scale=[0,2,4,7,9,12,14,16,19,21,24];break;case"chromatic":default:this.scale=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24]}if(1===t.range){var a=this.scale.findIndex((function(e){return e>12}));this.scale=this.scale.slice(0,a)}this.synth=new f.a.Synth(t.synth).toMaster(),this.random_note=this.random_note.bind(this),this.play_note=this.play_note.bind(this),this.play_rand_note=this.play_rand_note.bind(this)}return Object(i.a)(e,[{key:"random_note",value:function(){return-1===this.prev_note?(this.prev_note=this.scale[_(this.scale.length)],v[this.prev_note]):(this.prev_note=function(e){return e[_(e.length)]}(function(e,t,a){for(var n,l,o=0;e[o]<t-a;)o+=1;for(n=o;o<e.length&&e[o]<t+a;)o+=1;return l=o,e.slice(n,l+1)}(this.scale,this.prev_note,this.max_leap)),v[this.prev_note])}},{key:"play_note",value:function(e){this.synth.triggerAttackRelease(e,this.duration)}},{key:"play_notes",value:function(e){for(var t=.25,a=0;a<e.length;++a)this.synth.triggerAttackRelease(e[a],this.duration,"+"+t),t+=this.gap}},{key:"play_rand_note",value:function(){var e=this.random_note(this.duration);return this.play_note(e),e}},{key:"play_rand_seq",value:function(){for(var e=[],t=.25,a=0;a<this.num_notes;++a)e[a]=this.random_note(),this.synth.triggerAttackRelease(e[a],this.duration,"+"+t),t+=this.gap;return e}}]),e}();function A(e){return l.a.createElement("div",{className:"key",onClick:function(t){return e.onNoteClick(e.name)}})}function w(e){return l.a.createElement("div",{className:"key black",onClick:function(t){return e.onNoteClick(e.name)}})}function j(e){return 1===e.range?l.a.createElement(S,{props:!0}):l.a.createElement("div",{className:"piano"},l.a.createElement(A,{name:"C4",onNoteClick:e.onNoteClick}),l.a.createElement(w,{name:"C#4",onNoteClick:e.onNoteClick}),l.a.createElement(A,{name:"D4",onNoteClick:e.onNoteClick}),l.a.createElement(w,{name:"Eb4",onNoteClick:e.onNoteClick}),l.a.createElement(A,{name:"E4",onNoteClick:e.onNoteClick}),l.a.createElement(A,{name:"F4",onNoteClick:e.onNoteClick}),l.a.createElement(w,{name:"F#4",onNoteClick:e.onNoteClick}),l.a.createElement(A,{name:"G4",onNoteClick:e.onNoteClick}),l.a.createElement(w,{name:"Ab4",onNoteClick:e.onNoteClick}),l.a.createElement(A,{name:"A4",onNoteClick:e.onNoteClick}),l.a.createElement(w,{name:"Bb4",onNoteClick:e.onNoteClick}),l.a.createElement(A,{name:"B4",onNoteClick:e.onNoteClick}),l.a.createElement(A,{name:"C5",onNoteClick:e.onNoteClick}),l.a.createElement(w,{name:"C#5",onNoteClick:e.onNoteClick}),l.a.createElement(A,{name:"D5",onNoteClick:e.onNoteClick}),l.a.createElement(w,{name:"Eb5",onNoteClick:e.onNoteClick}),l.a.createElement(A,{name:"E5",onNoteClick:e.onNoteClick}),l.a.createElement(A,{name:"F5",onNoteClick:e.onNoteClick}),l.a.createElement(w,{name:"F#5",onNoteClick:e.onNoteClick}),l.a.createElement(A,{name:"G5",onNoteClick:e.onNoteClick}),l.a.createElement(w,{name:"Ab5",onNoteClick:e.onNoteClick}),l.a.createElement(A,{name:"A5",onNoteClick:e.onNoteClick}),l.a.createElement(w,{name:"Bb5",onNoteClick:e.onNoteClick}),l.a.createElement(A,{name:"B5",onNoteClick:e.onNoteClick}),l.a.createElement(A,{name:"C6",onNoteClick:e.onNoteClick}))}function S(e){return l.a.createElement("div",{className:"piano phone"},l.a.createElement(A,{name:"C4",onNoteClick:e.onNoteClick}),l.a.createElement(w,{name:"C#4",onNoteClick:e.onNoteClick}),l.a.createElement(A,{name:"D4",onNoteClick:e.onNoteClick}),l.a.createElement(w,{name:"Eb4",onNoteClick:e.onNoteClick}),l.a.createElement(A,{name:"E4",onNoteClick:e.onNoteClick}),l.a.createElement(A,{name:"F4",onNoteClick:e.onNoteClick}),l.a.createElement(w,{name:"F#4",onNoteClick:e.onNoteClick}),l.a.createElement(A,{name:"G4",onNoteClick:e.onNoteClick}),l.a.createElement(w,{name:"Ab4",onNoteClick:e.onNoteClick}),l.a.createElement(A,{name:"A4",onNoteClick:e.onNoteClick}),l.a.createElement(w,{name:"Bb4",onNoteClick:e.onNoteClick}),l.a.createElement(A,{name:"B4",onNoteClick:e.onNoteClick}),l.a.createElement(A,{name:"C5",onNoteClick:e.onNoteClick}))}function O(e){return l.a.createElement("div",{className:"note",content:e.name,style:{top:e.top,bottom:e.bottom,left:e.left},onClick:function(t){return e.onNoteClick(e.name)},onMouseOver:function(t){e.onHover(e.name)}})}function R(e){var t=Object(n.useRef)(null);return Object(n.useEffect)((function(){var a=t.current.getContext("2d");a.fillStyle="#FFF";for(var n=e.height-e.gap,l=0;l<5;++l)a.fillRect(0,n-l*e.gap,e.width,e.fill)}),[]),l.a.createElement("canvas",{className:"lines",ref:t,width:e.width,height:e.height})}var x=["C4","D4","E4","F4","G4","A4","B4","C5","D5","E5","F5","G5","A5","B5","C6"];var G=function(e){var t=Object(n.useState)(x),a=Object(c.a)(t,2),o=a[0],s=(a[1],Object(n.useState)(o)),r=Object(c.a)(s,2),i=r[0],u=r[1],m=Object(n.useState)("."),h=Object(c.a)(m,2),p=h[0],k=h[1];return Object(n.useEffect)((function(){1===e.range?u(o.slice(0,Math.ceil(o.length/2))):u(o)}),[o,e.range]),l.a.createElement("div",null,l.a.createElement("div",{className:"staff",height:200},l.a.createElement(R,{width:700,height:200,gap:30,fill:1}),i.map((function(t,a){return l.a.createElement(O,{key:t,name:t,bottom:15+15*a,left:100+30*a,onNoteClick:e.onNoteClick,onHover:k})}))),p)},B=new N,F=null;function I(e){var t=Object(n.useState)(""),a=Object(c.a)(t,2),o=a[0],s=a[1];return l.a.createElement("div",null,l.a.createElement("button",{className:"App-button colorPurple",onClick:function(t){return e.swapUI()}},"UI"),l.a.createElement("button",{className:"App-button colorBlue",onClick:function(t){return e.swapRange()}},"Range"),l.a.createElement("p",null,l.a.createElement(k.b,{to:"/train"},l.a.createElement("button",{className:"App-button colorGreen",onClick:e.onStart},"Start")),l.a.createElement(k.b,{to:"/settings"},l.a.createElement("button",{className:"App-button colorCoral"},"Settings")),l.a.createElement(k.b,{to:"/results"},l.a.createElement("button",{className:"App-button colorYellow"},"Results"))),l.a.createElement("div",null,l.a.createElement("p",null,"Play a Note:"),l.a.createElement(e.ui,{mode:e.mode,range:e.range,onNoteClick:function(t){console.log(t),null===F&&(F=new y(e)),F.play_note(t),s(t)}}),l.a.createElement("p",null,"Note Played:"),l.a.createElement("p",null,o)))}function D(e){var t=Object(n.useState)(""),a=Object(c.a)(t,2),o=a[0],s=a[1],r=Object(n.useState)(""),i=Object(c.a)(r,2),u=i[0],m=i[1],h=Object(n.useState)(null),p=Object(c.a)(h,2),E=p[0],N=p[1];return l.a.createElement("div",null,l.a.createElement("p",null,l.a.createElement(k.b,{to:"/"},l.a.createElement("button",{className:"App-button colorGreen"},"Stop")),l.a.createElement(k.b,{to:"/settings"},l.a.createElement("button",{className:"App-button colorCoral"},"Settings")),l.a.createElement(k.b,{to:"/results"},l.a.createElement("button",{className:"App-button colorYellow"},"Results"))),l.a.createElement("div",{className:"App"},l.a.createElement("div",null,e.replay&&l.a.createElement("button",{className:"App-button colorYellow",onClick:function(e){null!==F&&(console.log("replay:",o),F.play_notes(o))}},"Replay"),l.a.createElement("button",{className:"App-button colorGreen",onClick:function(t){null===F&&(F=new y(e));var a=F.play_rand_seq();s(a),console.log(a),B.addNoteArr(a)}},"Next Note")),l.a.createElement(e.ui,{mode:e.mode,range:e.range,onNoteClick:function(e){B.guessed||m(e),N(B.addGuess(e))}}),l.a.createElement("p",null,"You Guessed:"),l.a.createElement("p",null,u,null===E?"":E?" : Correct":" : Incorrect")))}function U(e){return l.a.createElement("div",null,l.a.createElement("p",null,l.a.createElement(k.b,{to:"/"},l.a.createElement("button",{className:"App-button colorGreen"},"Start Over")),l.a.createElement(k.b,{to:"/settings"},l.a.createElement("button",{className:"App-button colorCoral"},"Settings")),l.a.createElement(k.b,{to:"/train"},l.a.createElement("button",{className:"App-button colorYellow"},"Continue"))),l.a.createElement(C,{guesses:B.guess_stack,notes:B.note_stack,results:B.result_stack,score:B.calcScore()}))}var M=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).state={ui:"staff",replay:!0,max_leap:3,mode:"major",num_notes:3,range:2,gap:1,duration:"4n",synth:{oscillator:{type:"triangle"},envelope:{attackCurve:"exponential",attack:.02,decayCurve:"exponential",decay:.03,sustain:.4,releaseCurve:"exponential",release:.5},portamento:0,volume:-15}},a.onStart=a.onStart.bind(Object(h.a)(a)),a.swapUI=a.swapUI.bind(Object(h.a)(a)),a.swapRange=a.swapRange.bind(Object(h.a)(a)),a}return Object(p.a)(t,e),Object(i.a)(t,[{key:"onStart",value:function(){console.log("resetting train data"),B=new N,F=new y(this.state)}},{key:"swapUI",value:function(){"piano"===this.state.ui?this.setState({ui:"staff"}):this.setState({ui:"piano"})}},{key:"swapRange",value:function(){1===this.state.range?this.setState({range:2}):2===this.state.range&&this.setState({range:1}),F=new y(this.state)}},{key:"render",value:function(){var e;return console.log("this.state.gap",this.state.gap),"piano"===this.state.ui?e=j:"staff"===this.state.ui&&(e=G),l.a.createElement("header",{className:"App App-header"},l.a.createElement("h1",null,"Aural Training"),l.a.createElement(k.a,null,l.a.createElement(E.c,null,l.a.createElement(E.a,{path:"/settings"},l.a.createElement(b,null)),l.a.createElement(E.a,{path:"/results"},l.a.createElement(U,{trainData:B})),l.a.createElement(E.a,{path:"/train"},l.a.createElement(D,{trainData:B,replay:this.state.replay,ui:e,duration:this.state.duration,max_leap:this.state.max_leap,mode:this.state.mode,num_notes:this.state.num_notes,range:this.state.range,gap:this.state.gap,synth:this.state.synth})),l.a.createElement(E.a,{path:"/"},l.a.createElement(I,{swapUI:this.swapUI,swapRange:this.swapRange,onStart:this.onStart,ui:e,duration:this.state.duration,max_leap:this.state.max_leap,mode:this.state.mode,num_notes:this.state.num_notes,range:this.state.range,gap:this.state.gap,synth:this.state.synth})))))}}]),t}(l.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(l.a.createElement(k.a,null,l.a.createElement(M,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},9:function(e,t,a){}},[[26,1,2]]]);
//# sourceMappingURL=main.185b9b28.chunk.js.map